<!DOCTYPE html>
<html>
<head>
<title>Locked Love Letter</title>

<style>
body{
  background:#1a0010;
  color:#ffb3c6;
  font-family:Arial;
  text-align:center;
  padding-top:10vh;
}
.box{
  background:#300018;
  width:60%;
  margin:auto;
  padding:30px;
  border-radius:15px;
}
button{
  margin-top:20px;
  padding:10px 20px;
  border:none;
  border-radius:12px;
  background:#ff4d7a;
  color:white;
  cursor:pointer;
}
.flag{
  color:#7CFFB2;
  margin-top:20px;
  font-weight:bold;
}
</style>
</head>

<body>

<div class="box">
<h1>Locked Love Letter</h1>

<p>
Some things only open when every piece is right.
</p>

<button onclick="openLetter()">Open Letter</button>

<div id="msg"></div>

<p style="opacity:0.6;">Made with love.</p>
</div>

<script>
function openLetter(){

  const q = new URLSearchParams(location.search);

  let x = q.get("x");
  let y = q.get("y");
  let z = q.get("z");

  let box = document.getElementById("msg");

  if(!x || !y || !z){
    box.innerText = "The letter stays closed.";
    return;
  }

  if(x + y + z === "314"){

    // Encoded flag (cannot decode without key)
    let data = [
      120,132,110,122,226,
      196,202,216,182,170,
      202,204,182,200,210,
      170,196,182,212,212,
      182,208,210,230
    ];

    let key = parseInt(x) + parseInt(y) + parseInt(z);

    let out = "";

    for(let i=0;i<data.length;i++){
      out += String.fromCharCode((data[i] - key) / 2);
    }

    box.innerHTML = "<div class='flag'>" + out + "</div>";

  } else {
    box.innerText = "The pieces donâ€™t align.";
  }
}
</script>

</body>
</html>
